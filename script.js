const translations = {
    fr: {
        nav_home: "Accueil",
        nav_about: "À propos",
        nav_skills: "Compétences",
        nav_projects: "Projets",
        nav_contact: "Contact",
        hero_greeting: "Bonjour, je suis",
        hero_desc_start: "Je suis passionné par",
        hero_btn_projects: "Voir mes projets",
        hero_btn_cv: "Télécharger mon CV",
        about_title: "À propos de moi",
        about_text1: "Je suis un professionnel dévoué avec une passion pour la création de solutions numériques innovantes. J'aime transformer des idées complexes en expériences utilisateur simples et élégantes.",
        about_text2: "Toujours à l'affût des dernières technologies, je m'efforce d'écrire un code propre et performant.",
        skills_title: "Mes Compétences",
        skill_db: "Base de données",
        skill_security: "Sécurité Informatique",
        projects_title: "Mes Projets",
        
        // Nouveaux statuts
        status_ongoing: "En Cours",
        status_completed: "Accomplis",

        proj_elearning_title: "Plateforme E-Learning Bénin",
        proj_elearning_desc: "Mise en place d'une plateforme e-learning d'apprentissage à distance surtout pour le Bénin.",
        proj_elearning_detail: "Une solution complète pour faciliter l'accès à l'éducation à distance au Bénin.",
        project_view_images: "Voir les images",
        project_view_demo: "Voir la démo",

        proj_1_title: "Expert en développement web",
        proj_1_desc: "Objectif : Atteindre un niveau avancé en développement web avec la decoverte de nouvelles frameworks et technologies.",
        proj_1_detail: "Parcours d'approfondissement en développement web : pratiques avancées, frameworks modernes et projets concrets.",
        proj_2_title: "Tômer C2 sunum",
        proj_2_desc: "YTB - SCU - Tômer",
        proj_2_detail: "Présentation de fin d'apprentissage de la langue turque sur le thème \"La prise de décisions à partir des données : les méthodes statistiques\".",
        
        proj_3_title: "Mentorat en Développement Web",
        proj_3_desc: "Programme de formation bénévole visant l'initiation et le perfectionnement technique.",
        proj_3_detail: "Animation de sessions interactives pour partager l'expertise technique, des fondamentaux du développement web aux frameworks modernes.",
        proj_3_btn_images: "Voir les images",
        proj_3_btn_platform: "Accéder à la plateforme d'apprentissage",

        // proj_4 (Sécurité) supprimé
        proj_5_title: "Rentrée Solennelle ENSPD 2025",
        proj_5_desc: "Réalisation de badges de participation",
        proj_5_detail: "Conception et génération des badges de participation pour les étudiants lors de la rentrée solennelle.",
        project_view: "Voir le projet",
        contact_title: "Me Contacter",
        contact_placeholder_name: "Votre Nom",
        contact_placeholder_email: "Votre Email",
        contact_placeholder_msg: "Votre Message",
        contact_btn_send: "Envoyer",
        footer_rights: "&copy; 2025 Alain Gounou Avoce – Tous droits réservés",
        typing_phrases: ["l'Analyse de Données", "la Cybersécurité", "le Développement Web"]
    },
    en: {
        nav_home: "Home",
        nav_about: "About",
        nav_skills: "Skills",
        nav_projects: "Projects",
        nav_contact: "Contact",
        hero_greeting: "Hello, I am",
        hero_desc_start: "I am passionate about",
        hero_btn_projects: "View my projects",
        hero_btn_cv: "Download my CV",
        about_title: "About Me",
        about_text1: "I am a dedicated professional with a passion for creating innovative digital solutions. I enjoy turning complex ideas into simple and elegant user experiences.",
        about_text2: "Always on the lookout for the latest technologies, I strive to write clean and efficient code.",
        skills_title: "My Skills",
        skill_db: "Databases",
        skill_security: "Cybersecurity",
        projects_title: "My Projects",
        
        // New statuses
        status_ongoing: "In Progress",
        status_completed: "Completed",

        proj_elearning_title: "Benin E-Learning Platform",
        proj_elearning_desc: "Implementation of a distance learning platform primarily for Benin.",
        proj_elearning_detail: "A complete solution to facilitate access to distance education in Benin.",
        project_view_images: "View Images",
        project_view_demo: "View Demo",

        proj_1_title: "Web Development Expert",
        proj_1_desc: "Goal: Reach an advanced level in web development by discovering new frameworks and technologies.",
        proj_1_detail: "Advanced web development path: modern frameworks, best practices, and real-world projects.",
        proj_2_title: "Tômer C2 Presentation",
        proj_2_desc: "YTB - SCU - Tômer",
        proj_2_detail: "Final Turkish language learning presentation on the theme “Decision-making from data: statistical methods.”",
        
        proj_3_title: "Web Development Mentorship",
        proj_3_desc: "Volunteer training program aimed at introducing and refining technical skills.",
        proj_3_detail: "Leading interactive sessions to share technical expertise, from web fundamentals to modern frameworks.",
        proj_3_btn_images: "View Images",
        proj_3_btn_platform: "Access Learning Platform",

        // proj_4 deleted
        proj_5_title: "ENSPD 2025 Formal Reopening",
        proj_5_desc: "Creation of participation badges",
        proj_5_detail: "Design and generation of participation badges for students during the formal reopening ceremony.",
        project_view: "View Project",
        contact_title: "Contact Me",
        contact_placeholder_name: "Your Name",
        contact_placeholder_email: "Your Email",
        contact_placeholder_msg: "Your Message",
        contact_btn_send: "Send",
        footer_rights: "&copy; 2025 Alain Gounou Avoce – All rights reserved",
        typing_phrases: ["Data Analysis", "Cybersecurity", "Web Development"]
    },
    tr: {
        nav_home: "Anasayfa",
        nav_about: "Hakkımda",
        nav_skills: "Beceriler",
        nav_projects: "Projeler",
        nav_contact: "İletişim",
        hero_greeting: "Merhaba, ben",
        hero_desc_start: "Tutkulu olduğum alanlar",
        hero_btn_projects: "Projelerimi Gör",
        hero_btn_cv: "CV İndir",
        about_title: "Hakkımda",
        about_text1: "Yenilikçi dijital çözümler yaratma tutkusuna sahip, kendini işine adamış bir profesyonelem. Karmaşık fikirleri basit ve zarif kullanıcı deneyimlerine dönüştürmekten keyif alıyorum.",
        about_text2: "Her zaman en son teknolojileri takip ederek, temiz ve yüksek performanslı kod yazmaya gayret ediyorum.",
        skills_title: "Becerilerim",
        skill_db: "Veritabanları",
        skill_security: "Siber Güvenlik",
        projects_title: "Projelerim",
        
        // New statuses
        status_ongoing: "Devam Eden",
        status_completed: "Tamamlanan",

        proj_elearning_title: "Benin E-Öğrenme Platformu",
        proj_elearning_desc: "Özellikle Benin için bir uzaktan eğitim platformunun kurulması.",
        proj_elearning_detail: "Benin'de uzaktan eğitime erişimi kolaylaştırmak için eksiksiz bir çözüm.",
        project_view_images: "Görüntüleri Gör",
        project_view_demo: "Demoyu Gör",

        proj_1_title: "Web Geliştirme Uzmanı",
        proj_1_desc: "Hedef: Yeni çerçeveler ve teknolojiler keşfederek web geliştirmede ileri bir seviyeye ulaşmak.",
        proj_1_detail: "Web geliştirmede ileri seviye: modern çerçeveler, iyi uygulamalar ve gerçek projeler.",
        proj_2_title: "Tömer C2 Sunumu",
        proj_2_desc: "YTB - SCU - Tömer",
        proj_2_detail: "Türkçe öğreniminin bitiş sunumu: \"Verilere dayalı karar alma: istatistiksel yöntemler\" teması.",
        
        proj_3_title: "Web Geliştirme Mentorluğu",
        proj_3_desc: "Teknik becerileri tanıtmayı ve geliştirmeyi amaçlayan gönüllü eğitim programı.",
        proj_3_detail: "Web temellerinden modern çatılara kadar teknik uzmanlığı paylaşmak için interaktif oturumlar düzenlemek.",
        proj_3_btn_images: "Görüntüleri Gör",
        proj_3_btn_platform: "Platforma Git",

        // proj_4 deleted
        proj_5_title: "ENSPD 2025 Resmi Açılış",
        proj_5_desc: "Katılım rozetlerinin hazırlanması",
        proj_5_detail: "Resmi açılış töreni sırasında öğrenciler için katılım rozetlerinin tasarlanması ve oluşturulması.",
        project_view: "Projeyi Gör",
        contact_title: "Bana Ulaşın",
        contact_placeholder_name: "Adınız",
        contact_placeholder_email: "E-postanız",
        contact_placeholder_msg: "Mesajınız",
        contact_btn_send: "Gönder",
        footer_rights: "&copy; 2025 Alain Gounou Avoce – Tüm hakları saklıdır",
        typing_phrases: ["Veri Analizi", "Siber Güvenlik", "Web Geliştirme"]
    }
};

let typingState = {
    element: null,
    phrases: [],
    phraseIndex: 0,
    charIndex: 0,
    isDeleting: false,
    timeoutId: null
};

function type() {
    if (!typingState.element || typingState.phrases.length === 0) return;

    const currentPhrase = typingState.phrases[typingState.phraseIndex];
    let typeSpeed = 100;
    
    if (typingState.isDeleting) {
        typingState.element.textContent = currentPhrase.substring(0, typingState.charIndex - 1);
        typingState.charIndex--;
        typeSpeed = 50; 
    } else {
        typingState.element.textContent = currentPhrase.substring(0, typingState.charIndex + 1);
        typingState.charIndex++;
        typeSpeed = 100;
    }

    if (!typingState.isDeleting && typingState.charIndex === currentPhrase.length) {
        typingState.isDeleting = true;
        typeSpeed = 2000; // Pause at end of phrase
    } else if (typingState.isDeleting && typingState.charIndex === 0) {
        typingState.isDeleting = false;
        typingState.phraseIndex = (typingState.phraseIndex + 1) % typingState.phrases.length;
        typeSpeed = 500; // Pause before new phrase
    }

    typingState.timeoutId = setTimeout(type, typeSpeed);
}

function changeLanguage(lang) {
    if (!translations[lang]) return;

    // Update text content
    document.querySelectorAll('[data-key]').forEach(element => {
        const key = element.getAttribute('data-key');
        if (translations[lang][key]) {
            // Handle HTML inside translations (like the icons) if necessary, 
            // but for simple text innerHTML is fine.
            // Note: The icons in the H3 tags are NOT inside the translation strings, 
            // so we must be careful not to overwrite the icon <i> tag if it were inside the span.
            // However, in the HTML, the data-key is on the H3.
            // To preserve the icon, we can do this:
            
            if(element.classList.contains('project-subtitle')) {
                 // Special handling for subtitles to keep the icon
                 const iconHTML = element.querySelector('i') ? element.querySelector('i').outerHTML : '';
                 element.innerHTML = translations[lang][key] + ' ' + iconHTML;
            } else {
                 element.innerHTML = translations[lang][key];
            }
        }
    });

    // Update typing effect
    if (translations[lang].typing_phrases) {
        typingState.phrases = translations[lang].typing_phrases;
        // Reset typing animation
        if (typingState.timeoutId) clearTimeout(typingState.timeoutId);
        typingState.phraseIndex = 0;
        typingState.charIndex = 0;
        typingState.isDeleting = false;
        if (typingState.element) {
             typingState.element.textContent = '';
             type();
        }
    }

    // Update placeholders
    document.querySelectorAll('[data-key-placeholder]').forEach(element => {
        const key = element.getAttribute('data-key-placeholder');
        if (translations[lang][key]) {
            element.setAttribute('placeholder', translations[lang][key]);
        }
    });

    // Update project detail tooltips and aria labels
    document.querySelectorAll('[data-detail-key]').forEach(element => {
        const key = element.getAttribute('data-detail-key');
        if (translations[lang][key]) {
            element.textContent = translations[lang][key];
            const card = element.closest('.project-card');
            if (card) {
                card.setAttribute('aria-label', translations[lang][key]);
            }
        }
    });
    
    // Update active button
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        // Simple check
         if (btn.getAttribute('onclick').includes(`'${lang}'`)) {
            btn.classList.add('active');
        }
    });

    // Save preference
    localStorage.setItem('preferredLanguage', lang);
    document.documentElement.lang = lang;
}


document.addEventListener('DOMContentLoaded', () => {
    
    // --- Typing Effect Initialization ---
    typingState.element = document.querySelector('.typing-text');

    // Language detection logic
    let defaultLang = 'en'; 
    const browserLang = navigator.language || navigator.userLanguage;
    const userLangCode = browserLang ? browserLang.split('-')[0] : 'en';

    if (translations[userLangCode]) {
        defaultLang = userLangCode;
    }

    const savedLang = localStorage.getItem('preferredLanguage') || defaultLang;
    changeLanguage(savedLang);


    // Contact Form Handling (AJAX)
    const contactForm = document.getElementById('contact-form');
    if (contactForm) {
        contactForm.addEventListener('submit', async function(event) {
            event.preventDefault();
            const status = document.getElementById('form-status');
            const data = new FormData(event.target);
            
            fetch(event.target.action, {
                method: contactForm.method,
                body: data,
                headers: {
                    'Accept': 'application/json'
                }
            }).then(response => {
                if (response.ok) {
                    status.innerHTML = "Merci ! Votre message a été envoyé avec succès.";
                    status.style.color = "#27ae60"; // Green
                    contactForm.reset();
                } else {
                    response.json().then(data => {
                        if (Object.hasOwn(data, 'errors')) {
                            status.innerHTML = data["errors"].map(error => error["message"]).join(", ");
                        } else {
                            status.innerHTML = "Oups! Il y a eu un problème lors de l'envoi.";
                        }
                    });
                     status.style.color = "#e74c3c"; // Red
                }
            }).catch(error => {
                status.innerHTML = "Oups! Il y a eu un problème lors de l'envoi.";
                 status.style.color = "#e74c3c";
            });
        });
    }

    // Mobile Menu Toggle
    const hamburger = document.querySelector('.hamburger');
    const navLinks = document.querySelector('.nav-links');

    hamburger.addEventListener('click', () => {
        navLinks.classList.toggle('active');
    });

    // Close mobile menu when clicking a link
    document.querySelectorAll('.nav-links a').forEach(link => {
        link.addEventListener('click', () => {
            navLinks.classList.remove('active');
        });
    });

    // Smooth Scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();

            const targetId = this.getAttribute('href');
            if (targetId === '#') return;

            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                const headerOffset = document.querySelector('header').offsetHeight;
                const elementPosition = targetElement.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

                window.scrollTo({
                    top: offsetPosition,
                    behavior: 'smooth'
                });
            }
        });
    });

    // Navbar scroll effect
    window.addEventListener('scroll', () => {
        const header = document.querySelector('header');
        if (window.scrollY > 50) {
            header.style.boxShadow = '0 2px 10px rgba(0,0,0,0.1)';
        } else {
            header.style.boxShadow = 'none';
        }
    });

    // --- Canvas Particle Animation ---
    const canvas = document.getElementById('hero-canvas');
    const ctx = canvas.getContext('2d');
    
    let particlesArray;

    // Set canvas size
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Handle window resize
    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        init();
    });

    // Mouse position
    let mouse = {
        x: null,
        y: null,
        radius: (canvas.height/100) * (canvas.width/100)
    }

    window.addEventListener('mousemove', (event) => {
        mouse.x = event.x;
        mouse.y = event.y;
    });
    
    window.addEventListener('mouseout', () => {
        mouse.x = null;
        mouse.y = null; 
    });

    // Create Particle Class
    class Particle {
        constructor(x, y, directionX, directionY, size, color, type) {
            this.x = x;
            this.y = y;
            this.directionX = directionX;
            this.directionY = directionY;
            this.size = size;
            this.color = color;
            this.type = type;
            
            // Assign symbol based on domain (Data, Cyber, Web)
            if (this.type === 'data') {
                const symbols = ['1', '0', '10', '01', '|'];
                this.text = symbols[Math.floor(Math.random() * symbols.length)];
            } else if (this.type === 'cyber') {
                const symbols = ['*', '#', '$_', '0x', '::'];
                this.text = symbols[Math.floor(Math.random() * symbols.length)];
            } else {
                const symbols = ['{ }', '< >', '</>', '();', '[]'];
                this.text = symbols[Math.floor(Math.random() * symbols.length)];
            }
        }

        draw() {
            ctx.font = 'bold ' + (10 + this.size * 5) + 'px "Courier New", monospace';
            ctx.shadowBlur = 5;
            ctx.shadowColor = this.color;
            ctx.fillStyle = this.color;
            ctx.fillText(this.text, this.x, this.y);
            ctx.shadowBlur = 0; 
        }

        update() {
            if (this.x > canvas.width || this.x < 0) {
                this.directionX = -this.directionX;
            }
            if (this.y > canvas.height || this.y < 0) {
                this.directionY = -this.directionY;
            }

            let dx = mouse.x - this.x;
            let dy = mouse.y - this.y;
            let distance = Math.sqrt(dx*dx + dy*dy);
            if (distance < mouse.radius + this.size){
                if (mouse.x < this.x && this.x < canvas.width - this.size * 10) {
                    this.x += 2; 
                }
                if (mouse.x > this.x && this.x > this.size * 10) {
                    this.x -= 2;
                }
                if (mouse.y < this.y && this.y < canvas.height - this.size * 10) {
                    this.y += 2;
                }
                if (mouse.y > this.y && this.y > this.size * 10) {
                    this.y -= 2;
                }
            }
            this.x += this.directionX;
            this.y += this.directionY;
            this.draw();
        }
    }

    function init() {
        particlesArray = [];
        let numberOfParticles = (canvas.height * canvas.width) / 9000;
        
        for (let i = 0; i < numberOfParticles; i++) {
            let size = (Math.random() * 1.5) + 0.5; 
            let x = (Math.random() * ((innerWidth - size * 2) - (size * 2)) + size * 2);
            let y = (Math.random() * ((innerHeight - size * 2) - (size * 2)) + size * 2);
            let directionX = (Math.random() * 0.4) - 0.2; 
            let directionY = (Math.random() * 0.4) - 0.2;
            
            let typeRandom = Math.random();
            let type, color;
            
            if (typeRandom < 0.33) {
                type = 'data';
                color = '#00f3ff'; 
            } else if (typeRandom < 0.66) {
                type = 'cyber';
                color = '#00ff41'; 
            } else {
                type = 'web';
                color = '#bd00ff'; 
            }
            
            if (Math.random() < 0.1) color = '#ffffff';

            particlesArray.push(new Particle(x, y, directionX, directionY, size, color, type));
        }
    }

    function animate() {
        requestAnimationFrame(animate);
        ctx.clearRect(0,0,innerWidth, innerHeight);

        for (let i = 0; i < particlesArray.length; i++) {
            particlesArray[i].update();
        }
        connect();
    }

    function connect() {
        let opacityValue = 1;
        for (let a = 0; a < particlesArray.length; a++) {
            for (let b = a; b < particlesArray.length; b++) {
                let distance = (( particlesArray[a].x - particlesArray[b].x) * (particlesArray[a].x - particlesArray[b].x)) + ((particlesArray[a].y - particlesArray[b].y) * (particlesArray[a].y - particlesArray[b].y));
                if (distance < (canvas.width/9) * (canvas.height/9)) {
                    opacityValue = 1 - (distance/15000);
                    ctx.strokeStyle = 'rgba(100, 200, 255,' + (opacityValue * 0.15) + ')'; 
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(particlesArray[a].x, particlesArray[a].y);
                    ctx.lineTo(particlesArray[b].x, particlesArray[b].y);
                    ctx.stroke();
                }
            }
        }
    }

    init();
    animate();
});